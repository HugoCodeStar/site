"use strict";(self.webpackChunkhugo_code_star_site=self.webpackChunkhugo_code_star_site||[]).push([[9133],{830:(e,n,a)=>{a.r(n),a.d(n,{contentTitle:()=>i,default:()=>d,frontMatter:()=>t,metadata:()=>s,toc:()=>o});var r=a(8168),l=(a(6540),a(5680));const t={title:"Librairie et Base de donn\xe9es SQL avec SQLite",sidebar_label:"8 - SQL et visualisation",sidebar_position:8},i="But",s={unversionedId:"inf1035/Cours/cours8",id:"inf1035/Cours/cours8",isDocsHomePage:!1,title:"Librairie et Base de donn\xe9es SQL avec SQLite",description:"* Un langage de requ\xeate qui permet de faire des requ\xeates complexes sans avoir beaucoup de logique programmable \xe0 faire.",source:"@site/docs/inf1035/Cours/cours8.md",sourceDirName:"inf1035/Cours",slug:"/inf1035/Cours/cours8",permalink:"/site/docs/inf1035/Cours/cours8",editUrl:"https://github.com/HugoCodeStar/site/edit/master/docs/inf1035/Cours/cours8.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{title:"Librairie et Base de donn\xe9es SQL avec SQLite",sidebar_label:"8 - SQL et visualisation",sidebar_position:8},sidebar:"INF1035Sidebar",previous:{title:"7 - Set, dictionnaire, csv et JSON",permalink:"/site/docs/inf1035/Cours/cours7"},next:{title:"X - Liste, Test & IDE",permalink:"/site/docs/inf1035/Cours/coursX"}},o=[{value:"Visualisation avec <code>matplotlib</code>",id:"visualisation-avec-matplotlib",children:[{value:"Importation",id:"importation",children:[]},{value:"Exemple initial",id:"exemple-initial",children:[]},{value:"La fonction <code>plot</code> pour un premier affichage",id:"la-fonction-plot-pour-un-premier-affichage",children:[]},{value:"Configuration des graphiques",id:"configuration-des-graphiques",children:[]},{value:"Ajustement des axes",id:"ajustement-des-axes",children:[]},{value:"Ajout de l\xe9gende",id:"ajout-de-l\xe9gende",children:[]}]},{value:"Type de graphiques",id:"type-de-graphiques",children:[{value:"Donn\xe9es X,Y",id:"donn\xe9es-xy",children:[]},{value:"Barre d&#39;erreur",id:"barre-derreur",children:[]},{value:"Histogramme",id:"histogramme",children:[]}]}],p={toc:o},u="wrapper";function d(e){let{components:n,...a}=e;return(0,l.yg)(u,(0,r.A)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"but"},"But"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Un langage de requ\xeate qui permet de faire des requ\xeates complexes sans avoir beaucoup de logique programmable \xe0 faire."),(0,l.yg)("li",{parentName:"ul"},"Le Structured Query Language (SQL) est le langage utilis\xe9 pour communiqu\xe9 avec les bases de donn\xe9es."),(0,l.yg)("li",{parentName:"ul"},"Plusieurs BD SQL existent (Postgres, Oracle, MariaDB). Nous utiliserons SQLite qui nous permet de travailler rapidement avec des bases de donn\xe9es sans infrastructures.")),(0,l.yg)("h1",{id:"tables"},"Tables"),(0,l.yg)("p",null,"Les informations d'une base de donn\xe9es sont regroup\xe9es en plusieurs tables de plusieurs colonnes. Chaque colonne porte un nom et peut contenir un type de donn\xe9e pr\xe9cise. Plusieurs lignes de donn\xe9es formeront l'information de la BD."),(0,l.yg)("h1",{id:"types-des-colonnes"},"Types des colonnes"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"NULL - Valeur nulle."),(0,l.yg)("li",{parentName:"ul"},"INTEGER - Entier sign\xe9."),(0,l.yg)("li",{parentName:"ul"},"REAL - Valeur flottante."),(0,l.yg)("li",{parentName:"ul"},"TEXT - Texte."),(0,l.yg)("li",{parentName:"ul"},"BLOB - Donn\xe9e ind\xe9finie.")),(0,l.yg)("h1",{id:"cr\xe9ation-de-tables"},"Cr\xe9ation de tables"),(0,l.yg)("p",null,"La cr\xe9ation d'une nouvelle table demande de nommer la table, ses colonnes et le type de chacune des colonnes."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE Client(\n    nom TEXT,\n    num_id INTEGER,\n    solde REAL\n);\n")),(0,l.yg)("h1",{id:"ajout-de-donn\xe9es-dans-une-table"},"Ajout de donn\xe9es dans une table"),(0,l.yg)("p",null,"L'ajout d'une ligne dans une table se fait avec la commande ",(0,l.yg)("inlineCode",{parentName:"p"},"INSERT"),"."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO Client\n    VALUES ('Bob', 34252, 2.34);\n\n-- On peut sp\xe9cifier quelle colonne remplir\nINSERT INTO Client(nom, num_id)\n    VALUES ('Bob', 34252);\n\nINSERT INTO Client\n    VALUES ('Annie', 21513, 346.25),\n        ('Julie', 135153, 2352.43);\n")),(0,l.yg)("h1",{id:"chercher-dans-la-table"},"Chercher dans la table"),(0,l.yg)("p",null,"La majorit\xe9 des interactions avec une base de donn\xe9es est d'aller chercher de l'information \xe0 l'int\xe9rieur de celle-ci. La commande ",(0,l.yg)("inlineCode",{parentName:"p"},"SELECT")," permet de faire des recherches dans les tables."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"SELECT * from Client;\n\n-- Le premier param\xe8tre est les colonnes \xe0 afficher\nSELECT nom,solde from Client;\n")),(0,l.yg)("h1",{id:"condition-de-s\xe9lection"},"Condition de s\xe9lection"),(0,l.yg)("p",null,"Il est possible de filtrer un ",(0,l.yg)("inlineCode",{parentName:"p"},"SELECT")," avec l'option ",(0,l.yg)("inlineCode",{parentName:"p"},"WHERE"),"."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"SELECT nom from Client WHERE solde < 0;\n")),(0,l.yg)("h1",{id:"modification-des-lignes---supprimer"},"Modification des lignes - Supprimer"),(0,l.yg)("p",null,"La commande ",(0,l.yg)("inlineCode",{parentName:"p"},"DELETE")," permet de supprimer des lignes."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"-- Supprime toutes les lignes\nDELETE FROM Client;\n\nDELETE FROM Client WHERE solde < 0;\n\n-- Supprime une table\nDROP TABLE Client;\n")),(0,l.yg)("h1",{id:"intr\xe9gration-de-sql-avec-python"},"Intr\xe9gration de SQL avec python"),(0,l.yg)("p",null,"La librairie sqlite3 permet de se connecter \xe0 une BD SQLite (un fichier). \xc0 partir de l\xe0, on peut envoyer des commandes et recevoir les r\xe9ponses de commandes SQL."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},'import sqlite3\nconn = sqlite3.connect("MaBD.db")\n\n# C\'est le curseur qui envoie les commandes et re\xe7oit nos r\xe9ponses.\ncur = conn.cursor()\n\ncur.close()\nconn.close()\n')),(0,l.yg)("h1",{id:"envoi-de-commande-avec-les-curseurs"},"Envoi de commande avec les curseurs"),(0,l.yg)("p",null,"Les commandes sont \xe9crites avec la m\xe9thode ",(0,l.yg)("inlineCode",{parentName:"p"},"execute")," et \xe9crite dans la base de donn\xe9es avec ",(0,l.yg)("inlineCode",{parentName:"p"},"commit")," pour les actions modifiantes la BD."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"cur.execute(\"INSERT INTO Client VALUES('Jean', 24432, 2.634)\")\nconn.commit()\n")),(0,l.yg)("h1",{id:"s\xe9lection-de-lignes-avec-les-curseurs"},"S\xe9lection de lignes avec les curseurs"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"cur.execute('SELECT * FROM Client')\n\n# Parcours avec un for\nfor e in cur:\n    print(e)\n\n# Gestion dans une liste\nma_liste = list(cur)\n\n# Insertion dans une liste\nres = cur.fetchall()\n")),(0,l.yg)("h2",{id:"visualisation-avec-matplotlib"},"Visualisation avec ",(0,l.yg)("inlineCode",{parentName:"h2"},"matplotlib")),(0,l.yg)("p",null,"La librairie ",(0,l.yg)("inlineCode",{parentName:"p"},"matplotlib")," est une librairie de visualisation bas\xe9e sur les graphiques disponibles sous le logiciel et langages de programmation MATLAB. Cette librairie permet de construire des graphiques qui vont nous permettre de visualiser les donn\xe9es sur lesquelles nous avons travaill\xe9."),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"matplotlib")," est la libraire de base que nous allons regarder, mais il existe des librairies de plus haut niveau avec des configurations qui facilite d'avoir des graphiques plus modernes. Les librairies sont :"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("a",{parentName:"li",href:"https://seaborn.pydata.org"},"Seaborn")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("a",{parentName:"li",href:"https://plotly.com"},"Plotly/Dash")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("a",{parentName:"li",href:"https://bokeh.org"},"Bokeh"))),(0,l.yg)("h3",{id:"importation"},"Importation"),(0,l.yg)("p",null,"Comme Numpy et Pandas, matplotlib \xe0 son propre raccourci. On utilise la sous-librairie de graphisme avec le nom ",(0,l.yg)("inlineCode",{parentName:"p"},"plt"),"."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"import matplotlib.pyplot as plt\n")),(0,l.yg)("h3",{id:"exemple-initial"},"Exemple initial"),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"matplotlib")," permet de prendre des donn\xe9es et des pr\xe9sent\xe9s sous forme de graphique. Nous regarderons les graphiques pr\xe9cis, mais le d\xe9but avec un exemple complet."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"import numpy as np\nx = np.linspace(0, 10, 100)\n\nfig = plt.figure() # Sauvegarde la figure pour enregistrement\nplt.plot(x, np.sin(x), '-')\nplt.plot(x, np.cos(x), '--');\n\n# Sauvegarde d'une image de la figure\nfig.savefig('my_figure.png')\n")),(0,l.yg)("h3",{id:"la-fonction-plot-pour-un-premier-affichage"},"La fonction ",(0,l.yg)("inlineCode",{parentName:"h3"},"plot")," pour un premier affichage"),(0,l.yg)("p",null,"Le plus simple est un graphique lin\xe9aire des donn\xe9es sur un axe X,Y qui sont reli\xe9s."),(0,l.yg)("p",null,"La m\xe9thode ",(0,l.yg)("inlineCode",{parentName:"p"},"plot")," permet de pr\xe9senter des s\xe9quences d'\xe9l\xe9ments repr\xe9sentant le X et le Y qui seront dessin\xe9s."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"# G\xe9n\xe8re 1000 valeurs de 0 \xe0 10\nx = np.linspace(0, 10, 1000)\n# Dessine le graphique\nplt.plot(x, np.sin(x));\n")),(0,l.yg)("h3",{id:"configuration-des-graphiques"},"Configuration des graphiques"),(0,l.yg)("p",null,"Plusieurs param\xe8tres nomm\xe9s sont disponibles pour configurer les graphiques."),(0,l.yg)("p",null,"La couleur"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"plt.plot(x, np.sin(x - 0), color='blue')        # specify color by name\nplt.plot(x, np.sin(x - 1), color='g')           # short color code (rgbcmyk)\nplt.plot(x, np.sin(x - 2), color='0.75')        # Grayscale between 0 and 1\nplt.plot(x, np.sin(x - 3), color='#FFDD44')     # Hex code (RRGGBB from 00 to FF)\nplt.plot(x, np.sin(x - 4), color=(1.0,0.2,0.3)) # RGB tuple, values 0 to 1\nplt.plot(x, np.sin(x - 5), color='chartreuse'); # all HTML color names supported\n")),(0,l.yg)("p",null,"Le type de trait"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"plt.plot(x, x + 0, linestyle='solid')\nplt.plot(x, x + 1, linestyle='dashed')\nplt.plot(x, x + 2, linestyle='dashdot')\nplt.plot(x, x + 3, linestyle='dotted');\n\n# For short, you can use the following codes:\nplt.plot(x, x + 4, linestyle='-')  # solid\nplt.plot(x, x + 5, linestyle='--') # dashed\nplt.plot(x, x + 6, linestyle='-.') # dashdot\nplt.plot(x, x + 7, linestyle=':');  # dotted\n")),(0,l.yg)("h3",{id:"ajustement-des-axes"},"Ajustement des axes"),(0,l.yg)("p",null,"Plusieurs m\xe9thodes sont aussi disponibles dans la construction des axes et leurs \xe9tiquettes."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},'plt.plot(x, np.sin(x))\n\nplt.xlim(-1, 11)\nplt.ylim(-1.5, 1.5)\n\nplt.title("A Sine Curve")\nplt.xlabel("x")\nplt.ylabel("sin(x)")\n')),(0,l.yg)("h3",{id:"ajout-de-l\xe9gende"},"Ajout de l\xe9gende"),(0,l.yg)("p",null,"Les donn\xe9es peuvent \xeatre identifi\xe9es pour ensuite ins\xe9rer une l\xe9gende qui les identifie."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"plt.plot(x, np.sin(x), '-g', label='sin(x)')\nplt.plot(x, np.cos(x), ':b', label='cos(x)')\nplt.axis('equal')\n\nplt.legend();\n")),(0,l.yg)("h2",{id:"type-de-graphiques"},"Type de graphiques"),(0,l.yg)("h3",{id:"donn\xe9es-xy"},"Donn\xe9es X,Y"),(0,l.yg)("p",null,"Nous avons vu que la fonction ",(0,l.yg)("inlineCode",{parentName:"p"},"plot")," permet de faire un graphique lign\xe9. Il est aussi possible de changer sa configuration pour qu'elle n'affiche que les points de donn\xe9es."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"x = np.linspace(0, 10, 30)\ny = np.sin(x)\n\nplt.plot(x, y, 'o', color='black')\n")),(0,l.yg)("p",null,'Des nuages de points sont donc possibles avec diff\xe9rents "marqueurs".'),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"rng = np.random.RandomState(0)\nfor marker in ['o', '.', ',', 'x', '+', 'v', '^', '<', '>', 's', 'd']:\n    plt.plot(rng.rand(5), rng.rand(5), marker,\n             label=\"marker='{0}'\".format(marker))\nplt.legend(numpoints=1)\nplt.xlim(0, 1.8)\n")),(0,l.yg)("p",null,"Pour des nuages de points plus complexes, la fonction ",(0,l.yg)("inlineCode",{parentName:"p"},"scatter")," permet d'avoir une troisi\xe8me information (couleur, taille, etc.) pour chaque point."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"rng = np.random.RandomState(0)\nx = rng.randn(100)\ny = rng.randn(100)\ncolors = rng.rand(100)\nsizes = 1000 * rng.rand(100)\n\nplt.scatter(x, y, c=colors, s=sizes, alpha=0.3,\n            cmap='viridis')\nplt.colorbar()  # show color scale\n")),(0,l.yg)("h4",{id:"exemple-de-nuages-de-points"},"Exemple de nuages de points"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"from sklearn.datasets import load_iris\niris = load_iris()\nfeatures = iris.data.T\n\nplt.scatter(features[0], features[1], alpha=0.2,\n            s=100*features[3], c=iris.target, cmap='viridis')\nplt.xlabel(iris.feature_names[0])\nplt.ylabel(iris.feature_names[1])\n")),(0,l.yg)("h3",{id:"barre-derreur"},"Barre d'erreur"),(0,l.yg)("p",null,"La m\xe9thode ",(0,l.yg)("inlineCode",{parentName:"p"},"errorbar")," est capable de pr\xe9senter des graphiques de barres d'erreur."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"x = np.linspace(0, 10, 50)\ndy = 0.8\ny = np.sin(x) + dy * np.random.randn(50)\n\nplt.errorbar(x, y, yerr=dy, fmt='.k')\n")),(0,l.yg)("h3",{id:"histogramme"},"Histogramme"),(0,l.yg)("p",null,"Des diagrammes \xe0 barres sont aussi disponibles avec ",(0,l.yg)("inlineCode",{parentName:"p"},"hist"),"."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"data = np.random.randn(1000)\nplt.hist(data)\n\n# Ou avec plus d'option\nplt.hist(data, bins=30, alpha=0.5,\n         histtype='stepfilled', color='steelblue',\n         edgecolor='none');\n")),(0,l.yg)("p",null,"Les diagrammes \xe0 barres peuvent aussi repr\xe9senter des donn\xe9es de 2 dimensions (heatmap) avec la m\xe9thode ",(0,l.yg)("inlineCode",{parentName:"p"},"hist2d"),"."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-python"},"mean = [0, 0]\ncov = [[1, 1], [1, 2]]\nx, y = np.random.multivariate_normal(mean, cov, 10000).T\n\nplt.hist2d(x, y, bins=30, cmap='Blues')\ncb = plt.colorbar()\ncb.set_label('counts in bin')\n")))}d.isMDXComponent=!0},5680:(e,n,a)=>{a.d(n,{xA:()=>u,yg:()=>m});var r=a(6540);function l(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function t(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(n){l(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,r,l=function(e,n){if(null==e)return{};var a,r,l={},t=Object.keys(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var o=r.createContext({}),p=function(e){var n=r.useContext(o),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},u=function(e){var n=p(e.components);return r.createElement(o.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var a=e.components,l=e.mdxType,t=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(a),g=l,m=d["".concat(o,".").concat(g)]||d[g]||c[g]||t;return a?r.createElement(m,i(i({ref:n},u),{},{components:a})):r.createElement(m,i({ref:n},u))}));function m(e,n){var a=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var t=a.length,i=new Array(t);i[0]=g;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s[d]="string"==typeof e?e:l,i[1]=s;for(var p=2;p<t;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}g.displayName="MDXCreateElement"}}]);